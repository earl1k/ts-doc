# Управление памятью

TS конфигурация позволяет адресовать до 4096Кб RAM и 512Кб ROM. Процессору вся эта память проецируется в виде 64Кб, разделенных на 4 окна по 16Кб. Для управления содержимым каждого окна предусмотрен свой 8 битный регист.

Номер окна|Диапазон памяти|Регистр управления окном|R/W|Init
----------|---------------|------------------------|---|----
0         |$0000-$3FFF    |Page0                   | W |$00
1         |$4000-$7FFF    |Page1                   | W |$05
2         |$8000-$BFFF    |Page2                   |R/W|$02
3         |$C000-$FFFF    |Page3                   |R/W|$00

Память компьютера разбивается на страницы по 16Кб, таким образом становится доступно до 256 страниц RAM и 32 страниц ROM. Для выбора конкретной страницы в любом окне, необходимо лишь записать номер этой страницы в соответствующий регистр.

В окнах 1, 2, 3 отображаются только страницы RAM. В окне 0 можно отображать страницы RAM или ROM, в зависимости от бита *W0_RAM* регистра **MemConfig** (0 - отображается ROM, 1 - отображается RAM). При этом для выбора страницы ROM используются только биты 4:0 регистра **Page0**.

##### Регистр MemConfig
	Биты   7    6    5    4    3       2      1     0
	     LCK128[1:0] -    -  W0_RAM !W0_MAP W0_WE ROM128
	R/W    W    W              W       W      W     W
	Init   0    0    x    x    0       1      0     0

* Биты 7:6 - выбор режима ограничений порта $7FFD,
* Биты 5:4 - зарезервированы,
* Бит 3 - выбор ROM/RAM,
* Бит 2 - отключение маппинга (0 - включен, 1 - выключен),
* Бит 1 - разрешение записи в ROM/RAM,
* Бит 0 - выбор страниц маппинга.

С помощью бита *W0_WE* регистра **MemConfig** можно запретить (значение 0) или разрешить (значение 1) запись в окно 0. Для страниц RAM - это просто запрет записи данных. Для ROM запись будет производится на флеш память.
